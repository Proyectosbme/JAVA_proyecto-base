<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
        <style>
            /* reset on the showcase style*/
            body .ui-panelgrid .ui-panelgrid-cell {
                background-color: transparent;
            }

        </style>
    </h:head>
    <h:body>
        <h:form id="form">
            <h1 class="estilo-titulo">Mantenimiento de modulos</h1>
            <p:tabView dynamic="true"   prependId="false" 
                       activeIndex="#{mttenimientoModulos.indexTab}">
                <p:tab title="Busqueda" >
                    <p:menubar styleClass="custom-menubar">
                        <p:menuitem value="Nuevo" 
                                    icon="pi pi-plus" 
                                    styleClass="custom-menuitem"
                                    action="#{mttenimientoModulos.iniciarModulo()}"/>
                        <p:menuitem value="Buscar"
                                    update="form"
                                    icon="pi pi-search" 
                                    styleClass="custom-menuitem"
                                    action="#{mttenimientoModulos.buscarModulo()}" />
                        <p:menuitem value="Limpiar" 
                                    icon="pi pi-trash"
                                    update="form" 
                                    styleClass="custom-menuitem"
                                    action="#{mttenimientoModulos.limpiarBusqueda()}" />
                    </p:menubar>
                    <p:focus context="pnModulos"/>
                    <p:panelGrid  id="pnModulos" columns="4" layout="grid" 
                                  styleClass="panel-stilo">
                        <p:outputLabel for="txtNomMod" value="Nombre" />
                        <p:inputText id="txtNomMod" value="#{mttenimientoModulos.nomModulo}"
                                     onkeypress="return validarSoloLetras(event)" />

                        <p:outputLabel for="txtCodmod" value="Codigo" />
                        <p:inputText id="txtCodmod" value="#{mttenimientoModulos.codModulo}"
                                     onkeypress="soloNumeros(event)"/>
                    </p:panelGrid>
                    <p:dataTable id="singleDT" var="m" value="#{mttenimientoModulos.lstModulos}" 
                                 rowKey="#{m.codmod}"
                                 paginator="true" 
                                 rows="10"
                                 paginatorPosition="bottom"
                                 selectionMode="single" 
                                 styleClass="style-table"
                                 selection="#{mttenimientoModulos.selectecModulo}">
                        <p:ajax event="rowSelect"  listener="#{mttenimientoModulos.cargarPantallas}" 
                                update="form"/>
                        <p:column headerText="Codigo">
                            <h:outputText value="#{m.codmod}"  />
                        </p:column>
                        <p:column headerText="Nombre">
                            <h:outputText value="#{m.nommodulo}" />
                        </p:column>
                        <p:column  headerText="EDITAR" 
                                   style="width:47px;text-align: center">
                            <p:commandButton  icon="pi pi-pencil" 
                                              update="editmodA"
                                              title="Icon Only" 
                                              action="#{mttenimientoModulos.asigEditarModulo(m)}" >
                            </p:commandButton>
                        </p:column>
                        <p:column headerText="ELIMINAR" 
                                  style="width:67px; text-align: center">
                            <p:commandButton  icon="pi pi-trash" 
                                              update="deleteModid"
                                              title="Icon Only" 
                                              action="#{mttenimientoModulos.asigModEliminar(m)}" >
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </p:tab>
                <p:tab title="Detalle">
                    <p:panelGrid columns="1"
                                 layout="grid"
                                 styleClass="my-panelgrid ui-panelgrid-blank ui-fluid"
                                 style="border:0px none; background-color:transparent;">
                        <p:row id="my-row-id2" styleClass="my-heading-row" style="font-weight: bold;">
                            MODULO : #{mttenimientoModulos.selectecModulo.nommodulo}
                        </p:row>
                        <p:dataTable id="catadeta" var="m" 
                                     value="#{mttenimientoModulos.selectecModulo.segpantallasList}" 
                                     rowKey="#{m.segmodulo.codmod}"
                                     paginator="true" 
                                     rows="10"
                                     paginatorPosition="bottom"
                                     styleClass="style-table"
                                     selectionMode="single" >
                            <p:column headerText="nombre">
                                <h:outputText value="#{m.nompantalla}" />
                            </p:column>
                            <p:column headerText="URL">
                                <h:outputText value="#{m.urlpantalla}" />
                            </p:column>
                            <p:column  headerText="EDITAR" 
                                       style="width:47px;text-align: center">
                                <p:commandButton  icon="pi pi-pencil" 
                                                  update="editPantalla"
                                                  title="Icon Only" 
                                                  action="#{mttenimientoModulos.asigEditarPantalla(m)}" >
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="ELIMINAR" 
                                      style="width:67px; text-align: center">
                                <p:commandButton  icon="pi pi-trash" 
                                                  update="deletePantaid"
                                                  title="Icon Only" 
                                                  action="#{mttenimientoModulos.asigPanEliminar(m)}" >
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                    </p:panelGrid>
                     <p:commandButton  value="Agregar" icon="pi pi-plus" 
                                          onclick="PF('addPantalla').show();" />
                </p:tab>
            </p:tabView>
        </h:form>
        <p:confirmDialog  global="true" 
                          showEffect="fade" 
                          hideEffect="fade"
                          id="deleteModid"
                          header="Confirmar eliminar el modulo" 
                          widgetVar="deleteMod"
                          message="Esta seguro de eliminar el modulo ?">
            <h:form>
                <p:commandButton value="Yes"  
                                 icon="pi pi-check" 
                                 actionListener="#{mttenimientoModulos.eliminarModulo()}"
                                 onclick="PF('eliminarModulo').hide();"/>
                <p:commandButton value="No" 
                                 icon="pi pi-times" 
                                 onclick="PF('eliminarModulo').hide();"
                                 />
            </h:form>
        </p:confirmDialog> 
        <!--dialogo para los msj-->
        <p:dialog id="busc" 
                  header="Informacion" 
                  widgetVar="dlgMensajes"
                  width="70%" height="40%"
                  modal="true"
                  >
            <p:messages 
                id="msj"
                showDetail="true" 
                closable="false"
                >
                <p:autoUpdate />
            </p:messages>
        </p:dialog>

        <!--dialogo para agregar modulo-->
        <p:dialog id="addModulo" 
                  header="Agregar Modulo" 
                  widgetVar="addModulo" 
                  minHeight="40"
                  width="30%"
                  modal="true">
            <h:form>
                <p:focus context="idAdmodulo"/>
                <h:panelGrid id="idAdmodulo" columns="2" cellpadding="7" styleClass="panel-stilo" >
                    <p:outputLabel for="lbNombre" value="Nombre :" />
                    <p:inputText id="lbNombre" 
                                 value="#{mttenimientoModulos.moduloAgregar.nommodulo}" 
                                 onkeypress="return validarSoloLetras(event)"/>
                </h:panelGrid>
                <p:commandButton value="Agregar"  update="form:singleDT " styleClass="mt-3"
                                 icon="pi pi-plus"  action="#{mttenimientoModulos.agregarModulo()}"/>
            </h:form>
        </p:dialog>


        <p:dialog id="editmodA"
                  header="Editar Modulo" 
                  widgetVar="editModulo" 
                  minHeight="40"
                  width="30%"
                  modal="true">
            <h:form>
                <h:panelGrid columns="2" cellpadding="7" styleClass="panel-stilo" >
                    <p:outputLabel for="lbNombre" value="Nombre :" styleClass="label-left" />  
                    <p:inputText id="lbNombre" value="#{mttenimientoModulos.selectecModulo.nommodulo}" 
                                 styleClass="input-right"
                                 onkeypress="return validarSoloLetras(event)"/>
                </h:panelGrid>
                <p:commandButton value="Agregar"  update="form:singleDT " styleClass="mt-3"
                                 icon="pi pi-plus"  action="#{mttenimientoModulos.editarModulo()}"/>
            </h:form>
        </p:dialog>
        <p:dialog id="editPantalla"
                  header="Editar Pantalla" 
                  widgetVar="editPantalla" 
                  minHeight="40"
                  width="40%"
                  modal="true">
            <h:form>
                <h:panelGrid columns="2" cellpadding="7" styleClass="panel-stilo" >
                    <p:outputLabel for="lbNombre" value="Nombre :" styleClass="label-left" />
                    <p:inputText id="lbNombre" value="#{mttenimientoModulos.editPantalla.nompantalla}" 
                                 styleClass="input-right" onkeypress="return validarSoloLetras(event)"/>
                    <p:outputLabel for="lbUrl" value="URL :" styleClass="label-left" />
                    <p:inputText id="lbUrl" 
                                 value="#{mttenimientoModulos.editPantalla.urlpantalla}" 
                                 styleClass="input-right" onkeypress="return validarSoloLetras(event)"/>
                </h:panelGrid>
                <p:commandButton value="Agregar"  update="form:catadeta" styleClass="mt-3"
                                 icon="pi pi-plus"  action="#{mttenimientoModulos.editarPantalla()}"/>
            </h:form>
        </p:dialog>
        <p:confirmDialog  global="true" 
                          showEffect="fade" 
                          hideEffect="fade"
                          id="deletePantaid"
                          header="Confirmar eliminar pantalla" 
                          widgetVar="deletePantaid"
                          message="Esta seguro de eliminar la pantalla ?">
            <h:form>
                <p:commandButton value="Yes"  
                                 icon="pi pi-check" 
                                 update="form:catadeta"
                                 actionListener="#{mttenimientoModulos.eliminarPantalla()}"
                                 onclick="PF('deletePantaid').hide();"/>
                <p:commandButton value="No" 
                                 icon="pi pi-times" 
                                 onclick="PF('deletePantaid').hide();"
                                 />
            </h:form>
        </p:confirmDialog> 

        <!--dialogo para agregar modulo-->
        <p:dialog header="Guardar pantalla" 
                  widgetVar="addPantalla" 
                  minHeight="40"
                  width="60%"
                  modal="true">
            <h:form>
                <h:panelGrid columns="2" cellpadding="7" styleClass="panel-stilo" >
                    <p:outputLabel for="lbNombrePan" value="Nombre :" 
                                   styleClass="label-left" />
                    <p:inputText id="lbNombrePan"
                                 value="#{mttenimientoModulos.addPantalla.nompantalla}" 
                                 styleClass="input-right"
                                 onkeypress="return validarSoloLetras(event)"/>
                    <p:outputLabel for="lbUrlPan" value="URL :" 
                                   styleClass="label-left" />
                    <p:inputText id="lbUrlPan"
                                 value="#{mttenimientoModulos.addPantalla.urlpantalla}" 
                                 styleClass="input-right"
                                 />
                </h:panelGrid>
                <p:commandButton value="Agregar"    update="form:catadeta" styleClass="mt-3"
                                 icon="pi pi-plus"  action="#{mttenimientoModulos.guardarPantalla()}"/>
            </h:form>

        </p:dialog>
    </h:body>
</html>

