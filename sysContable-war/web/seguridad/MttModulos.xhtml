<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
        <style type="text/css">
            .ui-panelgrid.showcase-text-align-center .ui-grid-responsive .ui-panelgrid-cell {
                text-align: center;
            }

            .customPanelGrid .ui-panelgrid-content {
                align-items: center;
            }

        </style>
    </h:head>
    <h:body>
        <h:form id="form">
            <p:tabView dynamic="true" activeIndex="#{mttenimientoModulos.indexTab}">
                <p:tab title="Busqueda" >
                    <p:toolbar>
                        <f:facet name="left">
                            <p:commandButton type="button" value="Agregar" icon="pi pi-plus" onclick="PF('addModulo').show();" />
                            <p:commandButton type="button" value="Limpiar" icon="pi pi-folder-open"
                                             />
                        </f:facet>
                    </p:toolbar>
                    <p:panel style="margin: none">
                        <p:dataTable id="singleDT" var="m" value="#{mttenimientoModulos.lstModulos}" 
                                     rowKey="#{m.codmod}"
                                     paginator="true" 
                                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rows="10"
                                     paginatorPosition="bottom"
                                     styleClass="excel-style"
                                     selectionMode="single" 
                                     selection="#{mttenimientoModulos.selectecModulo}">
                            <p:ajax event="rowSelect"  listener="#{mttenimientoModulos.cargarPantallas}" 
                                    update="form"/>
                            <f:facet name="header">
                                MODULOS
                            </f:facet>

                            <p:column headerText="Codigo">
                                <h:outputText value="#{m.codmod}" />
                            </p:column>
                            <p:column headerText="Nombre">
                                <h:outputText value="#{m.nommodulo}" />
                            </p:column>
                            <p:column  headerText="EDITAR" 
                                       style="width:47px;text-align: center">
                                <p:commandButton  icon="pi pi-pencil" 
                                                  update="editmodA"
                                                  title="Icon Only" 
                                                  action="#{mttenimientoModulos.asigEditarModulo(m)}" >
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="ELIMINAR" 
                                      style="width:67px; text-align: center">
                                <p:commandButton  icon="pi pi-trash" 
                                                  update="deleteModid"
                                                  title="Icon Only" 
                                                  action="#{mttenimientoModulos.asigModEliminar(m)}" >
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>

                    </p:panel>

                </p:tab>
                <p:tab title="Detalle">
                    <p:panel  styleClass="panel-pantalla">
                        <f:facet  name="header">
                            <h:outputText value=  "MODULO : #{mttenimientoModulos.selectecModulo.nommodulo}"/>
                        </f:facet>
                        <p:dataTable id="catadeta" var="m" 
                                     value="#{mttenimientoModulos.selectecModulo.segpantallasList}" 
                                     rowKey="#{m.segmodulo.codmod}"
                                     paginator="true" 
                                     rows="10"
                                     paginatorPosition="bottom"
                                     styleClass="excel-style"
                                     selectionMode="single" >
                            <f:facet name="header">
                                Pantalla del modulo
                            </f:facet>
                            <p:column headerText="nombre">
                                <h:outputText value="#{m.nompantalla}" />
                            </p:column>
                            <p:column headerText="URL">
                                <h:outputText value="#{m.urlpantalla}" />
                            </p:column>
                            <p:column  headerText="EDITAR" 
                                       style="width:47px;text-align: center">
                                <p:commandButton  icon="pi pi-pencil" 
                                                  update="editPantalla"
                                                  title="Icon Only" 
                                                  action="#{mttenimientoModulos.asigEditarPantalla(m)}" >
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="ELIMINAR" 
                                      style="width:67px; text-align: center">
                                <p:commandButton  icon="pi pi-trash" 
                                                  update="deletePantaid"
                                                  title="Icon Only" 
                                                  action="#{mttenimientoModulos.asigPanEliminar(m)}" >
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                </p:tab>
            </p:tabView>
        </h:form>
        <p:confirmDialog  global="true" 
                          showEffect="fade" 
                          hideEffect="fade"
                          id="deleteModid"
                          header="Confirmar eliminar la pantalla" 
                          widgetVar="deleteMod"
                          message="Esta seguro de eliminar la pantalla ?">
            <h:form>
                <p:commandButton value="Yes"  
                                 icon="pi pi-check" 
                                 actionListener="#{mttenimientoModulos.eliminarModulo()}"
                                 onclick="PF('eliminarModulo').hide();"/>
                <p:commandButton value="No" 
                                 icon="pi pi-times" 
                                 onclick="PF('eliminarModulo').hide();"
                                 />
            </h:form>
        </p:confirmDialog> 
        <!--dialogo para los msj-->
        <p:dialog id="busc" 
                  header="Informacion" 
                  widgetVar="dlg1"
                  width="70%" height="40%"
                  modal="true"
                  >
            <p:messages 
                id="msj"
                showDetail="true" 
                closable="false"
                >
                <p:autoUpdate />
            </p:messages>
        </p:dialog>

        <!--dialogo para agregar modulo-->
        <p:dialog header="Agregar Modulo" 
                  widgetVar="addModulo" 
                  minHeight="40"
                  width="30%"
                  modal="true">
            <h:form>
                <p:toolbar>
                    <f:facet name="left">
                        <p:commandButton  value="Agregar" icon="pi pi-plus" 
                                          ajax="false"
                                          action="#{mttenimientoModulos.agregarModulo()}"/>
                    </f:facet>
                </p:toolbar>
                <br></br>
                <p:panelGrid columns="2" layout="grid" 
                             styleClass="ui-panelgrid-blank ui-fluid"
                             >
                    <p:column>
                        <div class="responsive-label-input">
                            <p:outputLabel for="lbNombre" value="Nombre :" styleClass="label-left" />
                            <p:inputText id="lbNombre" value="#{mttenimientoModulos.nomModulo}" styleClass="input-right"/>
                        </div>
                    </p:column>
                </p:panelGrid>
            </h:form>
        </p:dialog>


        <p:dialog id="editmodA"
                  header="Editar Modulo" 
                  widgetVar="editModulo" 
                  minHeight="40"
                  width="30%"
                  modal="true">
            <h:form>
                <p:toolbar>
                    <f:facet name="left">
                        <p:commandButton  value="Agregar" icon="pi pi-plus" 
                                          ajax="false"
                                          action="#{mttenimientoModulos.editarModulo()}"/>
                    </f:facet>
                </p:toolbar>
                <br></br>
                <p:panelGrid columns="2" layout="grid" 
                             styleClass="ui-panelgrid-blank ui-fluid"
                             >
                    <p:outputLabel for="lbNombre" value="Nombre :" styleClass="label-left" />  
                    <p:inputText id="lbNombre" value="#{mttenimientoModulos.selectecModulo.nommodulo}" styleClass="input-right"/>
                </p:panelGrid>
            </h:form>
        </p:dialog>
        <p:dialog id="editPantalla"
                  header="Editar Modulo" 
                  widgetVar="editPantalla" 
                  minHeight="40"
                  width="30%"
                  modal="true">
            <h:form>
                <p:toolbar>
                    <f:facet name="left">
                        <p:commandButton  value="Agregar" icon="pi pi-plus" 
                                          ajax="false"
                                          action="#{mttenimientoModulos.editarPantalla()}"/>
                    </f:facet>
                </p:toolbar>
                <br></br>
                <p:panelGrid columns="2" layout="grid" 
                             styleClass="ui-panelgrid-blank ui-fluid"
                             >
                    <p:outputLabel for="lbNombre" value="Nombre :" styleClass="label-left" />
                    <p:inputText id="lbNombre" value="#{mttenimientoModulos.editPantalla.nompantalla}" styleClass="input-right"/>
                    <p:outputLabel for="lbUrl" value="URL :" styleClass="label-left" />
                    <p:inputText id="lbUrl" 
                                 value="#{mttenimientoModulos.editPantalla.urlpantalla}" 
                                 styleClass="input-right"/>
                </p:panelGrid>
            </h:form>
        </p:dialog>
           <p:confirmDialog  global="true" 
                              showEffect="fade" 
                              hideEffect="fade"
                              id="deletePantaid"
                              header="Confirmar eliminar pantalla" 
                              widgetVar="deletePantaid"
                              message="Esta seguro de eliminar la pantalla ?">
                <h:form>
                    <p:commandButton value="Yes"  
                                     icon="pi pi-check" 
                                     ajax="false"
                                     actionListener="#{mttenimientoModulos.eliminarPantalla()}"
                                     onclick="PF('deletePantaid').hide();"/>
                    <p:commandButton value="No" 
                                     icon="pi pi-times" 
                                     onclick="PF('deletePantaid').hide();"
                                     />
                </h:form>
            </p:confirmDialog> 
    </h:body>
</html>

