<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
    </h:head>
    <h:body>
        <h1 class="estilo-titulo">Mantenimiento de usuarios</h1>
        <h:form id="formUsuarios">
            <p:tabView dynamic="true"   prependId="false" 
                       activeIndex="#{mttUsuarios.indexTab}" >
                <p:tab title="Busqueda">
                    <p:menubar styleClass="custom-menubar">
                        <p:menuitem value="Buscar" 
                                    icon="pi pi-plus"
                                    update="formUsuarios:singleDT"
                                    styleClass="custom-menuitem"
                                    action="#{mttUsuarios.buscarUsuario()}"/>
                            <p:menuitem value="Limpiar" 
                                    icon="pi pi-trash"
                                    update="formUsuarios"
                                    styleClass="custom-menuitem"
                                    action="#{mttUsuarios.limpiarBusqueda()}"/>
                    </p:menubar>
                    <p:panelGrid  id="pnModulos" columns="4" layout="grid" 
                                  styleClass="panel-stilo">
                        <p:outputLabel value="Nombre" for="@next"/>
                        <p:autoComplete id="atcNombre" value="#{mttUsuarios.nombre}"
                                        completeMethod="#{mttUsuarios.obtenerNombre}" 
                                        minQueryLength="3" scrollHeight="250"
                                        onkeypress="return validarSoloLetras(event)" 
                                        inputStyleClass="inputTest" 
                                        />
                        <p:outputLabel for="txtCodUser" value="Codigo de usuario" />
                        <p:inputText id="txtCodUser" value="#{mttUsuarios.codUser}"
                                     onkeypress="return validarSoloLetras(event)"/>

                        <p:outputLabel for="lblcorrelativo" value="Sucursal" />
                        <p:selectOneMenu id="lblcorrelativo" value="#{mttUsuarios.corSucursal}">
                            <f:selectItem itemLabel="Seleccione" itemValue="" />
                            <f:selectItems value="#{mttUsuarios.itmSucursales}" />
                        </p:selectOneMenu>

                    </p:panelGrid>
                    <p:dataTable id="singleDT" var="m" value="#{mttUsuarios.lstUsuarios}" 
                                 rowKey="#{m.coduser}"
                                 paginator="true" 
                                 paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rows="10"
                                 styleClass="style-table"
                                 paginatorPosition="bottom"
                                 selectionMode="single" 
                                 selection="#{mttUsuarios.selectUsuario}">
                        <p:ajax event="rowSelect"  listener="#{mttUsuarios.cargarUsuario()}" 
                                update="formUsuarios"/>
                        <p:column headerText="Codigo">
                            <h:outputText value="#{m.coduser}" />
                        </p:column>
                        <p:column headerText="Nombre">
                            <h:outputText value="#{m.persona.nomcom}" />
                        </p:column>
                        <p:column headerText="Punto de venta">
                            <h:outputText value="#{m.persona.puntoventa.nombre}" />
                        </p:column>
                        <p:column headerText="Punto de venta">
                            <h:outputText value="#{m.estado==1? 'activo':'inactivo'}" />
                        </p:column>

                    </p:dataTable>
                </p:tab>
                <p:tab title="Detalle">
                      <p:menubar styleClass="custom-menubar">
                        <p:menuitem value="Buscar" 
                                    icon="pi pi-plus"
                                    update="formUsuarios:singleDT"
                                    styleClass="custom-menuitem"
                                    action="#{mttUsuarios.buscarUsuario()}"/>
                            <p:menuitem value="Limpiar" 
                                    icon="pi pi-trash"
                                    update="formUsuarios"
                                    styleClass="custom-menuitem"
                                    action="#{mttUsuarios.limpiarBusqueda()}"/>
                    </p:menubar>
                    <p:panelGrid  id="pnUserdt" columns="4" layout="grid" 
                                  styleClass="panel-stilo">
                        <p:outputLabel for="txtCodUserdt" value="Nombre" />
                        <p:inputText id="txtCodUserdt" value="#{mttUsuarios.nombreUser}"
                                     onkeypress="return validarSoloLetras(event)"/>
                        <p:outputLabel for="lblsucursaldt" value="Sucursal" />
                        <p:selectOneMenu id="lblsucursaldt" value="#{mttUsuarios.corrVenta}">
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{mttUsuarios.itmSucursales}" />
                        </p:selectOneMenu>
                        <p:outputLabel for="txtcodusdt" value="Codigo de usuario" />
                        <p:inputText id="txtcodusdt" value="#{mttUsuarios.codiUser}"
                                     onkeypress="return validarSoloLetras(event)"/>
                        <p:outputLabel for="txtdurclavedt" value="Duracion de clave" />
                        <p:inputText id="txtdurclavedt" value="#{mttUsuarios.duraClave}"
                                     onkeypress="return validarSoloLetras(event)"/>
                        <p:outputLabel for="txtestadodt" value="Estado" />
                        <p:selectOneMenu id="txtestadodt" value="#{mttUsuarios.estado}">
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItem itemLabel="Activo" itemValue="1" />
                            <f:selectItem itemLabel="inactivo" itemValue="2" />
                        </p:selectOneMenu>
                        <p:outputLabel for="txtperfildt" value="Perfil" />
                        <p:selectOneMenu id="txtperfildt" value="#{mttUsuarios.codPerfil}">
                            <f:selectItem itemLabel="Seleccione" itemValue="0" />
                            <f:selectItems value="#{mttUsuarios.itmPerfiles}" />
                        </p:selectOneMenu>
                    </p:panelGrid>
                </p:tab>
            </p:tabView>
        </h:form>
        <!--dialogo para los msj-->
        <p:dialog id="busc" 
                  header="Informacion" 
                  widgetVar="dlgMensajes"
                  width="70%" height="40%"
                  modal="true"
                  >
            <p:messages 
                id="msj"
                showDetail="true" 
                closable="false"
                >
                <p:autoUpdate />
            </p:messages>
        </p:dialog>
    </h:body>
</html>

